/**
 * USE id="tags" TO ENABLE HASHTAG
 */
!function(s){var r=new Array,d=new Array;s.fn.doAutosize=function(t){var a=s(this).data("minwidth"),e=s(this).data("maxwidth"),i="",n=s(this),u=s("#"+s(this).data("tester_id"));if(i!==(i=n.val())){var r=i.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");u.html(r);var d=u.width(),o=d+t.comfortZone>=a?d+t.comfortZone:a;(o<n.width()&&a<=o||a<o&&o<e)&&n.width(o)}},s.fn.resetAutosize=function(t){var a=s(this).data("minwidth")||t.minInputWidth||s(this).width(),e=s(this).data("maxwidth")||t.maxInputWidth||s(this).closest(".tagsinput").width()-t.inputPadding,i=s(this),n=s("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"300px",fontSize:i.css("fontSize"),fontFamily:i.css("fontFamily"),fontWeight:i.css("fontWeight"),letterSpacing:i.css("letterSpacing"),whiteSpace:"nowrap"}),u=s(this).attr("id")+"_autosize_tester";0<!s("#"+u).length&&(n.attr("id",u),n.appendTo("body")),i.data("minwidth",a),i.data("maxwidth",e),i.data("tester_id",u),i.css("width",a)},s.fn.addTag=function(n,u){return u=jQuery.extend({focus:!1,callback:!0},u),this.each(function(){var t=s(this).attr("id"),a=s(this).val().split(r[t]);if(""==a[0]&&(a=new Array),n=jQuery.trim(n),u.unique)1==(e=s(this).tagExist(n))&&s("#"+t+"_tag").addClass("not_valid");else var e=!1;if(""!=n&&1!=e){if(s("<span>").addClass("tag").append(s("<span>").text(n).append("&nbsp;&nbsp;"),s("<a>",{href:"#",title:"移除 tag",text:"×"}).click(function(){return s("#"+t).removeTag(escape(n))})).insertBefore("#"+t+"_addTag"),a.push(n),s("#"+t+"_tag").val(""),u.focus?s("#"+t+"_tag").focus():s("#"+t+"_tag").blur(),s.fn.tagsInput.updateTagsField(this,a),u.callback&&d[t]&&d[t].onAddTag)d[t].onAddTag.call(this,n);if(d[t]&&d[t].onChange){var i=a.length;d[t].onChange.call(this,s(this),a[i-1])}}}),!1},s.fn.removeTag=function(e){return e=unescape(e),this.each(function(){var t=s(this).attr("id"),a=s(this).val().split(r[t]);for(s("#"+t+"_tagsinput .tag").remove(),str="",i=0;i<a.length;i++)a[i]!=e&&(str=str+r[t]+a[i]);s.fn.tagsInput.importTags(this,str),d[t]&&d[t].onRemoveTag&&d[t].onRemoveTag.call(this,e)}),!1},s.fn.tagExist=function(t){var a=s(this).attr("id"),e=s(this).val().split(r[a]);return 0<=jQuery.inArray(t,e)},s.fn.importTags=function(t){var a=s(this).attr("id");s("#"+a+"_tagsinput .tag").remove(),s.fn.tagsInput.importTags(this,t)},s.fn.tagsInput=function(t){var n=jQuery.extend({interactive:!0,defaultText:"",minChars:0,width:"",height:"",autocomplete:{selectFirst:!1},hide:!0,delimiter:",",unique:!0,removeWithBackspace:!0,placeholderColor:"#666666",autosize:!0,comfortZone:20,inputPadding:12},t),e=0;return this.each(function(){if(void 0===s(this).attr("data-tagsinput-init")){s(this).attr("data-tagsinput-init",!0),n.hide&&s(this).hide();var i=s(this).attr("id");i&&!r[s(this).attr("id")]||(i=s(this).attr("id","tags"+(new Date).getTime()+e++).attr("id"));var t=jQuery.extend({pid:i,real_input:"#"+i,holder:"#"+i+"_tagsinput",input_wrapper:"#"+i+"_addTag",fake_input:"#"+i+"_tag"},n);r[i]=t.delimiter,(n.onAddTag||n.onRemoveTag||n.onChange)&&(d[i]=new Array,d[i].onAddTag=n.onAddTag,d[i].onRemoveTag=n.onRemoveTag,d[i].onChange=n.onChange);var a='<div id="'+i+'_tagsinput" class="tagsinput"><div id="'+i+'_addTag">';if(n.interactive&&(a=a+'<input id="'+i+'_tag" value="" data-default="'+n.defaultText+'" />'),s(a+='</div><div class="tags_clear"></div></div>').insertAfter(this),s(t.holder).css("width",n.width),s(t.holder).css("min-height",n.height),s(t.holder).css("height",n.height),""!=s(t.real_input).val()&&s.fn.tagsInput.importTags(s(t.real_input),s(t.real_input).val()),n.interactive){if(s(t.fake_input).val(s(t.fake_input).attr("data-default")),s(t.fake_input).css("color",n.placeholderColor),s(t.fake_input).resetAutosize(n),s(t.holder).bind("click",t,function(t){s(t.data.fake_input).focus()}),s(t.fake_input).bind("focus",t,function(t){s(t.data.fake_input).val()==s(t.data.fake_input).attr("data-default")&&s(t.data.fake_input).val(""),s(t.data.fake_input).css("color","#262626")}),null!=n.autocomplete_url){for(attrname in autocomplete_options={source:n.autocomplete_url},n.autocomplete)autocomplete_options[attrname]=n.autocomplete[attrname];void 0!==jQuery.Autocompleter?(s(t.fake_input).autocomplete(n.autocomplete_url,n.autocomplete),s(t.fake_input).bind("result",t,function(t,a,e){a&&s("#"+i).addTag(a[0]+"",{focus:!0,unique:n.unique})})):void 0!==jQuery.ui.autocomplete&&(s(t.fake_input).autocomplete(autocomplete_options),s(t.fake_input).bind("autocompleteselect",t,function(t,a){return s(t.data.real_input).addTag(a.item.value,{focus:!0,unique:n.unique}),!1}))}else s(t.fake_input).bind("blur",t,function(t){var a=s(this).attr("data-default");return""!=s(t.data.fake_input).val()&&s(t.data.fake_input).val()!=a?t.data.minChars<=s(t.data.fake_input).val().length&&(!t.data.maxChars||t.data.maxChars>=s(t.data.fake_input).val().length)&&s(t.data.real_input).addTag(s(t.data.fake_input).val(),{focus:!0,unique:n.unique}):(s(t.data.fake_input).val(s(t.data.fake_input).attr("data-default")),s(t.data.fake_input).css("color",n.placeholderColor)),!1});s(t.fake_input).bind("keypress",t,function(t){if(u(t))return t.preventDefault(),t.data.minChars<=s(t.data.fake_input).val().length&&(!t.data.maxChars||t.data.maxChars>=s(t.data.fake_input).val().length)&&s(t.data.real_input).addTag(s(t.data.fake_input).val(),{focus:!0,unique:n.unique}),s(t.data.fake_input).resetAutosize(n),!1;t.data.autosize&&s(t.data.fake_input).doAutosize(n)}),t.removeWithBackspace&&s(t.fake_input).bind("keydown",function(t){if(8==t.keyCode&&""==s(this).val()){t.preventDefault();var a=s(this).closest(".tagsinput").find(".tag:last").text(),e=s(this).attr("id").replace(/_tag$/,"");a=a.replace(/[\s]+x$/,""),s("#"+e).removeTag(escape(a)),s(this).trigger("focus")}}),s(t.fake_input).blur(),t.unique&&s(t.fake_input).keydown(function(t){8!=t.keyCode&&!String.fromCharCode(t.which).match(/\w+|[Ã¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘,/]+/)||s(this).removeClass("not_valid")})}}}),this},s.fn.tagsInput.updateTagsField=function(t,a){var e=s(t).attr("id");s(t).val(a.join(r[e]))},s.fn.tagsInput.importTags=function(t,a){s(t).val("");var e=s(t).attr("id"),n=a.split(r[e]);for(i=0;i<n.length;i++)s(t).addTag(n[i],{focus:!1,callback:!1});d[e]&&d[e].onChange&&d[e].onChange.call(t,t,n[i])};var u=function(e){var i=!1;return 13==e.which||("string"==typeof e.data.delimiter?e.which==e.data.delimiter.charCodeAt(0)&&(i=!0):s.each(e.data.delimiter,function(t,a){e.which==a.charCodeAt(0)&&(i=!0)}),i)}}(jQuery);

$('#tags').tagsInput({
	'defaultText': ''
});
